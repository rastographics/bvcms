!function(a){if(typeof ko!="undefined"&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect){ko.bindingHandlers.multiselect={init:function(e,f,c,g,d){},update:function(e,g,c,h,d){var f=a(e).data("multiselect");if(!f){a(e).multiselect(ko.utils.unwrapObservable(g()))}else{if(c().options&&c().options().length!==f.originalOptions.length){f.updateOriginalOptions();a(e).multiselect("rebuild")}}}}}function b(e,d){this.options=this.getOptions(d);this.$select=a(e);this.originalOptions=this.$select.clone()[0].options;this.query="";this.searchTimeout=null;this.options.multiple=this.$select.attr("multiple")=="multiple";this.$container=a(this.options.buttonContainer).append('<button type="button" class="multiselect dropdown-toggle '+this.options.buttonClass+'" data-toggle="dropdown">'+this.options.buttonText(this.getSelected(),this.$select)+"</button>").append('<ul class="multiselect-container dropdown-menu'+(this.options.dropRight?" pull-right":"")+'"></ul>');if(this.options.buttonWidth){a("button",this.$container).css({width:this.options.buttonWidth})}var f=this.$select.attr("tabindex");if(f){a("button",this.$container).attr("tabindex",f)}if(this.options.maxHeight){a(".multiselect-container",this.$container).css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"})}if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var c=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=c){this.buildFilter()}}this.buildSelectAll();this.buildDropdown();this.updateButtonText();this.$select.hide().after(this.$container)}b.prototype={defaults:{buttonText:function(c,d){if(c.length==0){return this.nonSelectedText+' <b class="caret"></b>'}else{if(c.length>3){return c.length+" "+this.nSelectedText+' <b class="caret"></b>'}else{var e="";c.each(function(){var f=(a(this).attr("label")!==undefined)?a(this).attr("label"):a(this).html();e+=f+", "});return e.substr(0,e.length-2)+' <b class="caret"></b>'}}},buttonTitle:function(c,d){var e="";c.each(function(){e+=a(this).text()+", "});return e.substr(0,e.length-2)},onChange:function(d,c){},buttonClass:"btn",dropRight:false,selectedClass:"active",buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',maxHeight:false,includeSelectAllOption:false,selectAllText:" Select all",selectAllValue:"multiselect-all",enableFiltering:false,enableCaseInsensitiveFiltering:false,filterPlaceholder:"Search",filterBehavior:"text",preventInputChangeEvent:false,nonSelectedText:"None selected",nSelectedText:"selected"},constructor:b,createOptionValue:function(e){if(a(e).is(":selected")){a(e).attr("selected","selected").prop("selected",true)}var g=a(e).attr("label")||a(e).html();var i=a(e).val();var f=this.options.multiple?"checkbox":"radio";var d=a('<li><a href="javascript:void(0);"><label class="'+f+'"><input type="'+f+'" /></label></a></li>');var h=a(e).prop("selected")||false;var c=a("input",d);c.val(i);if(i==this.options.selectAllValue){c.parent().parent().addClass("multiselect-all")}a("label",d).append(" "+g);a(".multiselect-container",this.$container).append(d);if(a(e).is(":disabled")){c.attr("disabled","disabled").prop("disabled",true).parents("li").addClass("disabled")}c.prop("checked",h);if(h&&this.options.selectedClass){c.parents("li").addClass(this.options.selectedClass)}},createOptgroup:function(d){var e=a(d).prop("label");var c=a('<li><label class="multiselect-group"></label></li>');a("label",c).text(e);a(".multiselect-container",this.$container).append(c);a("option",d).each(a.proxy(function(g,f){this.createOptionValue(f)},this))},toggleActiveState:function(){if(this.$select.attr("disabled")==undefined){a("button.multiselect.dropdown-toggle",this.$container).removeClass("disabled")}else{a("button.multiselect.dropdown-toggle",this.$container).addClass("disabled")}},buildSelectAll:function(){var c=this.$select[0][0]?this.$select[0][0].value==this.options.selectAllValue:false;if(this.options.includeSelectAllOption&&this.options.multiple&&!c){this.$select.prepend('<option value="'+this.options.selectAllValue+'">'+this.options.selectAllText+"</option>")}},buildDropdown:function(){this.toggleActiveState();this.$select.children().each(a.proxy(function(d,c){var e=a(c).prop("tagName").toLowerCase();if(e=="optgroup"){this.createOptgroup(c)}else{if(e=="option"){this.createOptionValue(c)}}},this));a(".multiselect-container li input",this.$container).on("change",a.proxy(function(g){var f=a(g.target).prop("checked")||false;var h=a(g.target).val()==this.options.selectAllValue;if(this.options.selectedClass){if(f){a(g.target).parents("li").addClass(this.options.selectedClass)}else{a(g.target).parents("li").removeClass(this.options.selectedClass)}}var d=a("option",this.$select).filter(function(){return a(this).val()==a(g.target).val()});var e=a("option",this.$select).not(d);var c=a("input",this.$container).not(a(g.target));if(h){c.filter(function(){return a(this).is(":checked")!=f}).trigger("click")}if(f){d.prop("selected",true);if(this.options.multiple){d.attr("selected","selected")}else{if(this.options.selectedClass){a(c).parents("li").removeClass(this.options.selectedClass)}a(c).prop("checked",false);e.removeAttr("selected").prop("selected",false);a(this.$container).find(".multiselect.dropdown-toggle").click()}if(this.options.selectedClass=="active"){e.parents("a").css("outline","")}}else{d.removeAttr("selected").prop("selected",false)}this.updateButtonText();this.options.onChange(d,f);this.$select.change();if(this.options.preventInputChangeEvent){return false}},this));a(".multiselect-container li a",this.$container).on("touchstart click",function(c){c.stopPropagation();a(c.target).blur()});this.$container.on("keydown",a.proxy(function(f){if(a('input[type="text"]',this.$container).is(":focus")){return}if((f.keyCode==9||f.keyCode==27)&&this.$container.hasClass("open")){a(this.$container).find(".multiselect.dropdown-toggle").click()}else{var e=a(this.$container).find("li:not(.divider):visible a");if(!e.length){return}var g=e.index(e.filter(":focus"));if(f.keyCode==38&&g>0){g--}else{if(f.keyCode==40&&g<e.length-1){g++}else{if(!~g){g=0}}}var d=e.eq(g);d.focus();if(this.options.selectedClass=="active"){d.css("outline","thin dotted #333").css("outline","5px auto -webkit-focus-ring-color");e.not(d).css("outline","")}if(f.keyCode==32||f.keyCode==13){var c=d.find("input");c.prop("checked",!c.prop("checked"));c.change()}f.stopPropagation();f.preventDefault()}},this))},buildFilter:function(){a(".multiselect-container",this.$container).prepend('<div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text" placeholder="'+this.options.filterPlaceholder+'"></div>');a(".multiselect-search",this.$container).val(this.query).on("click",function(c){c.stopPropagation()}).on("keydown",a.proxy(function(c){clearTimeout(this.searchTimeout);this.searchTimeout=this.asyncFunction(a.proxy(function(){if(this.query!=c.target.value){this.query=c.target.value;a.each(a(".multiselect-container li",this.$container),a.proxy(function(f,d){var i=a("input",d).val();if(i!=this.options.selectAllValue){var h=a("label",d).text();var i=a("input",d).val();if(i&&h&&i!=this.options.selectAllValue){var g=false;var e="";if((this.options.filterBehavior=="text"||this.options.filterBehavior=="both")){e=h}if((this.options.filterBehavior=="value"||this.options.filterBehavior=="both")){e=i}if(this.options.enableCaseInsensitiveFiltering&&e.toLowerCase().indexOf(this.query.toLowerCase())>-1){g=true}else{if(e.indexOf(this.query)>-1){g=true}}if(g){a(d).show()}else{a(d).hide()}}}},this))}},this),300,this)},this))},destroy:function(){this.$container.remove();this.$select.show()},refresh:function(){a("option",this.$select).each(a.proxy(function(e,d){var c=a(".multiselect-container li input",this.$container).filter(function(){return a(this).val()==a(d).val()});if(a(d).is(":selected")){c.prop("checked",true);if(this.options.selectedClass){c.parents("li").addClass(this.options.selectedClass)}}else{c.prop("checked",false);if(this.options.selectedClass){c.parents("li").removeClass(this.options.selectedClass)}}if(a(d).is(":disabled")){c.attr("disabled","disabled").prop("disabled",true).parents("li").addClass("disabled")}else{c.removeAttr("disabled").prop("disabled",false).parents("li").removeClass("disabled")}},this));this.updateButtonText()},select:function(f){if(f&&!a.isArray(f)){f=[f]}for(var e=0;e<f.length;e++){var g=f[e];var d=a("option",this.$select).filter(function(){return a(this).val()==g});var c=a(".multiselect-container li input",this.$container).filter(function(){return a(this).val()==g});if(this.options.selectedClass){c.parents("li").addClass(this.options.selectedClass)}c.prop("checked",true);d.attr("selected","selected").prop("selected",true);this.options.onChange(d,true)}this.updateButtonText()},deselect:function(e){if(e&&!a.isArray(e)){e=[e]}for(var f=0;f<e.length;f++){var g=e[f];var d=a("option",this.$select).filter(function(){return a(this).val()==g});var c=a(".multiselect-container li input",this.$container).filter(function(){return a(this).val()==g});if(this.options.selectedClass){c.parents("li").removeClass(this.options.selectedClass)}c.prop("checked",false);d.removeAttr("selected").prop("selected",false);this.options.onChange(d,false)}this.updateButtonText()},rebuild:function(){a(".multiselect-container",this.$container).html("");this.buildSelectAll();this.buildDropdown();this.updateButtonText();if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){this.buildFilter()}},dataprovider:function(c){var d="";c.forEach(function(e){d+='<option value="'+e.value+'">'+e.label+"</option>"});this.$select.html(d);this.rebuild()},getOptions:function(c){return a.extend({},this.defaults,c)},updateButtonText:function(){var c=this.getSelected();a("button",this.$container).html(this.options.buttonText(c,this.$select));a("button",this.$container).attr("title",this.options.buttonTitle(c,this.$select))},getSelected:function(){return a('option:selected[value!="'+this.options.selectAllValue+'"]',this.$select)},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(d,f,e){var c=Array.prototype.slice.call(arguments,3);return setTimeout(function(){d.apply(e||window,c)},f)}};a.fn.multiselect=function(c,d){return this.each(function(){var e=a(this).data("multiselect"),f=typeof c=="object"&&c;if(!e){a(this).data("multiselect",(e=new b(this,f)))}if(typeof c=="string"){e[c](d)}})};a.fn.multiselect.Constructor=b;a(function(){a("select[data-role=multiselect]").multiselect()})}(window.jQuery);/*
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(a){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var g={duration:"fast",direction:"both"};var e=/^(?:html)$/i;var b=function(i,k){k=k||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(i,null):i.currentStyle);var j=document.defaultView&&document.defaultView.getComputedStyle?true:false;var h={top:(parseFloat(j?k.borderTopWidth:a.css(i,"borderTopWidth"))||0),left:(parseFloat(j?k.borderLeftWidth:a.css(i,"borderLeftWidth"))||0),bottom:(parseFloat(j?k.borderBottomWidth:a.css(i,"borderBottomWidth"))||0),right:(parseFloat(j?k.borderRightWidth:a.css(i,"borderRightWidth"))||0)};return{top:h.top,left:h.left,bottom:h.bottom,right:h.right,vertical:h.top+h.bottom,horizontal:h.left+h.right}};var d=function(h){var j=a(window);var i=e.test(h[0].nodeName);return{border:i?{top:0,left:0,bottom:0,right:0}:b(h[0]),scroll:{top:(i?j:h).scrollTop(),left:(i?j:h).scrollLeft()},scrollbar:{right:i?0:h.innerWidth()-h[0].clientWidth,bottom:i?0:h.innerHeight()-h[0].clientHeight},rect:(function(){var k=h[0].getBoundingClientRect();return{top:i?0:k.top,left:i?0:k.left,bottom:i?h[0].clientHeight:k.bottom,right:i?h[0].clientWidth:k.right}})()}};a.fn.extend({scrollintoview:function(l){l=a.extend({},g,l);l.direction=c[typeof(l.direction)==="string"&&l.direction.toLowerCase()]||c.both;var j="";if(l.direction.x===true){j="horizontal"}if(l.direction.y===true){j=j?"both":"vertical"}var k=this.eq(0);var n=k.closest(":scrollable("+j+")");if(n.length>0){n=n.eq(0);var i={e:d(k),s:d(n)};var m={top:i.e.rect.top-(i.s.rect.top+i.s.border.top),bottom:i.s.rect.bottom-i.s.border.bottom-i.s.scrollbar.bottom-i.e.rect.bottom,left:i.e.rect.left-(i.s.rect.left+i.s.border.left),right:i.s.rect.right-i.s.border.right-i.s.scrollbar.right-i.e.rect.right};var h={};if(l.direction.y===true){if(m.top<0){h.scrollTop=i.s.scroll.top+m.top}else{if(m.top>0&&m.bottom<0){h.scrollTop=i.s.scroll.top+Math.min(m.top,-m.bottom)}}}if(l.direction.x===true){if(m.left<0){h.scrollLeft=i.s.scroll.left+m.left}else{if(m.left>0&&m.right<0){h.scrollLeft=i.s.scroll.left+Math.min(m.left,-m.right)}}}if(!a.isEmptyObject(h)){if(e.test(n[0].nodeName)){n=a("html,body")}n.animate(h,l.duration).eq(0).queue(function(o){a.isFunction(l.complete)&&l.complete.call(n[0]);o()})}else{a.isFunction(l.complete)&&l.complete.call(n[0])}}return this}});var f={auto:true,scroll:true,visible:false,hidden:false};a.extend(a.expr[":"],{scrollable:function(i,j,k,n){var h=c[typeof(k[3])==="string"&&k[3].toLowerCase()]||c.both;var o=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(i,null):i.currentStyle);var l={x:f[o.overflowX.toLowerCase()]||false,y:f[o.overflowY.toLowerCase()]||false,isRoot:e.test(i.nodeName)};if(!l.x&&!l.y&&!l.isRoot){return false}var m={height:{scroll:i.scrollHeight,client:i.clientHeight},width:{scroll:i.scrollWidth,client:i.clientWidth},scrollableX:function(){return(l.x||l.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(l.y||l.isRoot)&&this.height.scroll>this.height.client}};return h.y&&m.scrollableY()||h.x&&m.scrollableX()}})})(jQuery);$(function(){$.postQuery=function(d,g,e){if($.isFunction(g)){e=g;g=undefined}if(g!==undefined){$("#SelectedId").val(g)}var f=$("#query-form").serialize();$.post("/Query/"+d,f,e)};var c;var a=$('<div class="modal-backdrop hide" />').appendTo("body");$("#conditions").on("click","a.edit-popover",function(){c=$(this).closest("li.condition");b();return false});var b=function(d){var e=c.data("qid");$("#editcondition").attr("originalheight",c.height());if($("#editcondition").is(":visible")){$.HideEditCondition()}$.postQuery("EditCondition",e,function(f){$("#editcondition .popover-content").html(f).ready(function(){$.AdjustEditCondition(d)})})};$("#SaveAs").click(function(d){d.preventDefault();var e=this.href;$("<div />").load("/Query/SaveAs",{id:$("#QueryId").val(),nametosaveas:$("#SaveToDescription").val()},function(){var g=$(this);var h=g.find("form");h.modal("show");h.on("hidden",function(){g.remove();h.remove()})})});$.AdjustEditCondition=function(e){$("#editcondition .date").datepicker({keyboardNavigation:true,orientation:"auto",forceParse:false});$("#editcondition select").multiselect({includeSelectAllOption:true,enableFiltering:true,enableCaseInsensitiveFiltering:true});var d=$("#editcondition").outerHeight();var f=c.position();var g=c.width();$("#editcondition").css({left:f.left,top:f.top+2,"min-width":g,"z-index":1041});a.removeClass("hide");c.animate({height:d},350);setTimeout(function(){$("#editcondition").slideDown(500,function(){$(this).scrollintoview();if(e&&e.isnew){$("#SelectCondition").click()}})},10)};$.HideEditCondition=function(){a.addClass("hide");var d=$("#editcondition").attr("originalheight");$("#editcondition").slideUp(150);var e=$("li[data-qid='"+$("#SelectedId").val()+"']");e.animate({height:d},400,function(){$("#editcondition .popover-content").empty()})};$("#CancelChange").live("click",function(){$.HideEditCondition();return false});$("#conditions header").live("mouseenter",function(){var d=$(this).closest("li");d.addClass("borderleftred")});$("#conditions header").live("mouseleave",function(){var d=$(this).closest("li");d.removeClass("borderleftred")});$("#SaveCondition").live("click",function(){$.postQuery("SaveCondition",function(d){if(d.startsWith("<fieldset")){$("#editcondition .popover-content").html(d).ready(function(){$.InitCodeValues()})}else{$.HideEditCondition();$("#conditions").html(d).ready(function(){RefreshList()})}});return false});$("#editForm input").live("keydown",function(d){if(d.keyCode==13){d.preventDefault();$("#SaveCondition").click();return false}});$("#conditions select.changegroup").live("change",function(){var e=$(this).val();c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("ChangeGroup/"+e,d,function(){RefreshList()});return false});$("#conditions a.addnewclause").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("AddNewCondition",d,function(e){$("#conditions").html(e).ready(function(){c=$("li[data-qid='"+$("#NewId").val()+"']");b({isnew:true})})});return false});$("#conditions a.addnewgroup").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("AddNewGroup",d,function(e){$("#conditions").html(e).ready(function(){c=$("li[data-qid='"+$("#NewId").val()+"']");b({isnew:true})})});return false});if($.ClipboardHasCondition){$("li.pastecondition").show()}$("#conditions a.cutcondition").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$(this).parent().parent().prev().dropdown("toggle");$.postQuery("Cut",d,function(e){$("#conditions").html(e).ready(function(){$("li.pastecondition").show();RefreshList()})});return false});$("#conditions a.copycondition").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("Copy",d);$(this).parent().parent().prev().dropdown("toggle");$("li.pastecondition").show();return false});$("#conditions a.pastecondition").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("Paste",d,function(e){$("#conditions").html(e);RefreshList()});return false});$("#conditions a.insgroupabove").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("InsGroupAbove",d,function(e){$("#conditions").html(e);RefreshList()});return false});$("#conditions a.maketopgroup").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");$.postQuery("MakeTopGroup",d,function(e){$("#conditions").html(e);RefreshList()});return false});$("#conditions a.delete").live("click",function(){c=$(this).closest("li.condition");var d=c.data("qid");bootbox.confirm("Are you sure you want to delete?",function(e){if(e===true){$.postQuery("RemoveCondition",d,function(f){$("#conditions").html(f);RefreshList()})}});return false});$("#Comparison").live("change",function(d){var e="#CodeValues";if($(e).length>0){$.postQuery("CodeSelect",function(f){$.replaceSelect("#CodeValues",f)})}});$("#Tags").click(function(d){$("#TagsPopup").show()});$.replaceSelect=function(e,d){$(e).multiselect("destroy").ready(function(){$(e).replaceWith(d).ready(function(){$(e).multiselect({enableFiltering:true,enableCaseInsensitiveFiltering:true})})})};$("#Program").live("change",function(d){$.postQuery("Divisions/"+$(this).val(),function(e){$.replaceSelect("#Division",e);$.replaceSelect("#Organization","<select id='Organization' name='Organization' style='display:none'><option value='0'>(not specified)</option></select>")})});$("#Division").live("change",function(){$.postQuery("Organizations/"+$(this).val(),function(d){$.replaceSelect("#Organization",d)})});$("#Run").live("click",function(d){RefreshList();return false});$("#Export").click(function(d){window.location="/Query/Export/"+$("#QueryId").val()});$("#SelectCondition").live("click",function(d){d.preventDefault();a.css({"z-index":1042});$("#QueryConditionSelect").modal("show");return false});$("#QueryConditionSelect").live("hidden",function(d){a.css({"z-index":1040})});$(".FieldLink a").click(function(d){d.preventDefault();var e=c.data("qid");$("#ConditionName").val(d.target.id);$.postQuery("SelectCondition",e,function(f){$("#QueryConditionSelect").modal("hide");$("#editcondition .popover-content").html(f).ready($.AdjustEditCondition)});return false});$.navigate=function(e,d){e+=(e.match(/\?/)?"&":"?")+d;window.location=e};$("a.help").live("click",function(d){d.preventDefault();var e="//www.bvcms.com/DocDialog/"+$(this).data("name");if(e.endsWith("-")){e=e+$("#ConditionName").val()}$("#helpcontent iframe").attr("src",e).ready(function(){$("#QueryConditionHelp").modal("show")})});if($("#NewSearchId").val()){c=$("li[data-qid='"+$("#NewSearchId").val()+"']");b({isnew:true})}else{if($("#AutoRun").val()==="True"){RefreshList()}}$("a.taguntag").live("click",function(d){$.post("/Query/ToggleTag/"+$(this).attr("value"),function(e){if(e.error){alert(e.error)}else{$(d.target).text(e.HasTag?"Remove":"Add")}});return false})});function RefreshList(a){$.ajax({type:"POST",url:"/Query/Results/",data:a,timeout:1200000,success:function(b){$("#toolbar").show();$("#results").html(b);$("#people tbody tr:even").addClass("alt");$("#people thead a.sortable").click(function(d){var e=$(this).text();var f=$("#Sort").val();$("#Sort").val(e);var c=$("#Direction").val();if(f==e&&c=="asc"){$("#Direction").val("desc")}else{$("#Direction").val("asc")}RefreshList();return false})},error:function(c,d,b){alert(b)}})}function ShowErrors(j){$(".validate").each(function(){$(this).next(".error").remove()});var e=eval("("+j+")");if(e.count==0){return false}$(".validate").each(function(){if(e[this.id]){$(this).after("<span class='error'> "+e[this.id]+"</span>")}});return true};/* http://mths.be/smoothscroll v1.5.2 by @mathias */
(function(c,a){var b=(function(){var e=a(c.documentElement),d=a(c.body),f;if(e.scrollTop()){return e}else{f=d.scrollTop();if(d.scrollTop(f+1).scrollTop()==f){return e}else{return d.scrollTop(f)}}}());a.fn.smoothScroll=function(d){d=~~d||400;return this.find('a[href*="#"]').click(function(f){var g=this.hash,e=a(g);if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){if(e.length){f.preventDefault();b.stop().animate({scrollTop:e.offset().top},d,function(){location.hash=g})}}}).end()}}(document,jQuery));(function(a,d){var c,b;b=d.document;c=(function(){function e(f){this._options=a.extend({name:"tour",container:"body",keyboard:true,storage:d.localStorage,debug:false,backdrop:false,redirect:true,orphan:false,duration:false,basePath:"",template:"<div class='popover'>          <div class='arrow'></div>          <h3 class='popover-title'></h3>          <div class='popover-content'></div>          <div class='popover-navigation'>            <div class='btn-group'>              <button class='btn btn-sm btn-default' data-role='prev'>&laquo; Prev</button>              <button class='btn btn-sm btn-default' data-role='next'>Next &raquo;</button>              <button class='btn btn-sm btn-default' data-role='pause-resume'                data-pause-text='Pause'                data-resume-text='Resume'              >Pause</button>            </div>            <button class='btn btn-sm btn-default' data-role='end'>End tour</button>          </div>        </div>",afterSetState:function(g,h){},afterGetState:function(g,h){},afterRemoveState:function(g){},onStart:function(g){},onEnd:function(g){},onShow:function(g){},onShown:function(g){},onHide:function(g){},onHidden:function(g){},onNext:function(g){},onPrev:function(g){},onPause:function(h,g){},onResume:function(h,g){}},f);this._force=false;this._inited=false;this._steps=[];this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:false,overlayElementShown:false}}e.prototype.setState=function(h,j){var g,i;if(this._options.storage){i=""+this._options.name+"_"+h;try{this._options.storage.setItem(i,j)}catch(f){g=f;if(g.code===DOMException.QUOTA_EXCEEDED_ERR){this.debug("LocalStorage quota exceeded. setState failed.")}}return this._options.afterSetState(i,j)}else{if(this._state==null){this._state={}}return this._state[h]=j}};e.prototype.removeState=function(f){var g;if(this._options.storage){g=""+this._options.name+"_"+f;this._options.storage.removeItem(g);return this._options.afterRemoveState(g)}else{if(this._state!=null){return delete this._state[f]}}};e.prototype.getState=function(f){var g,h;if(this._options.storage){g=""+this._options.name+"_"+f;h=this._options.storage.getItem(g)}else{if(this._state!=null){h=this._state[f]}}if(h===void 0||h==="null"){h=null}this._options.afterGetState(f,h);return h};e.prototype.addSteps=function(j){var i,f,g,h;h=[];for(f=0,g=j.length;f<g;f++){i=j[f];h.push(this.addStep(i))}return h};e.prototype.addStep=function(f){return this._steps.push(f)};e.prototype.getStep=function(f){if(this._steps[f]!=null){return a.extend({id:"step-"+f,path:"",placement:"right",title:"",content:"<p></p>",next:f===this._steps.length-1?-1:f+1,prev:f-1,animation:true,container:this._options.container,backdrop:this._options.backdrop,redirect:this._options.redirect,orphan:this._options.orphan,duration:this._options.duration,template:this._options.template,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume},this._steps[f])}};e.prototype.init=function(g){var f=this;this._force=g;if(this.ended()){return this._debug("Tour ended, init prevented.")}this.setCurrentStep();this._setupMouseNavigation();this._setupKeyboardNavigation();this._onResize(function(){return f.showStep(f._current)});if(this._current!==null){this.showStep(this._current)}this._inited=true;return this};e.prototype.start=function(f){var g;if(f==null){f=false}if(!this._inited){this.init(f)}if(this._current===null){g=this._makePromise(this._options.onStart!=null?this._options.onStart(this):void 0);return this._callOnPromiseDone(g,this.showStep,0)}};e.prototype.next=function(){var f;if(this.ended()){return this._debug("Tour ended, next prevented.")}f=this.hideStep(this._current);return this._callOnPromiseDone(f,this._showNextStep)};e.prototype.prev=function(){var f;if(this.ended()){return this._debug("Tour ended, prev prevented.")}f=this.hideStep(this._current);return this._callOnPromiseDone(f,this._showPrevStep)};e.prototype.goTo=function(f){var g;if(this.ended()){return this._debug("Tour ended, goTo prevented.")}g=this.hideStep(this._current);return this._callOnPromiseDone(g,this.showStep,f)};e.prototype.end=function(){var g,h,f=this;g=function(i){a(b).off("click.tour-"+f._options.name);a(b).off("keyup.tour-"+f._options.name);a(d).off("resize.tour-"+f._options.name);f.setState("end","yes");f._inited=false;f._force=false;f._clearTimer();if(f._options.onEnd!=null){return f._options.onEnd(f)}};h=this.hideStep(this._current);return this._callOnPromiseDone(h,g)};e.prototype.ended=function(){return !this._force&&!!this.getState("end")};e.prototype.restart=function(){this.removeState("current_step");this.removeState("end");this.setCurrentStep(0);return this.start()};e.prototype.pause=function(){var f;f=this.getStep(this._current);if(!(f&&f.duration)){return}this._paused=true;this._duration-=new Date().getTime()-this._start;d.clearTimeout(this._timer);this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining).");if(f.onPause!=null){return f.onPause(this,this._duration)}};e.prototype.resume=function(){var g,f=this;g=this.getStep(this._current);if(!(g&&g.duration)){return}this._paused=false;this._start=new Date().getTime();this._duration=this._duration||g.duration;this._timer=d.setTimeout(function(){if(f._isLast()){return f.next()}else{return f.end()}},this._duration);this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration);if((g.onResume!=null)&&this._duration!==g.duration){return g.onResume(this,this._duration)}};e.prototype.hideStep=function(h){var g,j,k,f=this;k=this.getStep(h);if(!k){return}this._clearTimer();j=this._makePromise(k.onHide!=null?k.onHide(this,h):void 0);g=function(l){var i;i=a(k.element);if(!(i.data("bs.popover")||i.data("popover"))){i=a("body")}i.popover("destroy");if(k.reflex){i.css("cursor","").off("click.tour-"+f._options.name)}if(k.backdrop){f._hideBackdrop()}if(k.onHidden!=null){return k.onHidden(f)}};this._callOnPromiseDone(j,g);return j};e.prototype.showStep=function(g){var h,j,k,l,f=this;l=this.getStep(g);if(!l){return}k=g<this._current;h=this._makePromise(l.onShow!=null?l.onShow(this,g):void 0);j=function(m){var i,n;f.setCurrentStep(g);n=a.isFunction(l.path)?l.path.call():f._options.basePath+l.path;i=[b.location.pathname,b.location.hash].join("");if(f._isRedirect(n,i)){f._redirect(l,n);return}if(f._isOrphan(l)){if(!l.orphan){f._debug("Skip the orphan step "+(f._current+1)+". Orphan option is false and the element doesn't exist or is hidden.");if(k){f._showPrevStep()}else{f._showNextStep()}return}f._debug("Show the orphan step "+(f._current+1)+". Orphans option is true.")}if(l.backdrop){f._showBackdrop(!f._isOrphan(l)?l.element:void 0)}f._scrollIntoView(l.element,function(){if((l.element!=null)&&l.backdrop){f._showOverlayElement(l.element)}f._showPopover(l,g);if(l.onShown!=null){l.onShown(f)}return f._debug("Step "+(f._current+1)+" of "+f._steps.length)});if(l.duration){return f.resume()}};this._callOnPromiseDone(h,j);return h};e.prototype.setCurrentStep=function(f){if(f!=null){this._current=f;this.setState("current_step",f)}else{this._current=this.getState("current_step");this._current=this._current===null?null:parseInt(this._current,10)}return this};e.prototype._showNextStep=function(){var g,h,i,f=this;i=this.getStep(this._current);h=function(j){return f.showStep(i.next)};g=this._makePromise((i.onNext!=null?i.onNext(this):void 0));return this._callOnPromiseDone(g,h)};e.prototype._showPrevStep=function(){var g,h,i,f=this;i=this.getStep(this._current);h=function(j){return f.showStep(i.prev)};g=this._makePromise((i.onPrev!=null?i.onPrev(this):void 0));return this._callOnPromiseDone(g,h)};e.prototype._debug=function(f){if(this._options.debug){return d.console.log("Bootstrap Tour '"+this._options.name+"' | "+f)}};e.prototype._isRedirect=function(g,f){return(g!=null)&&g!==""&&g.replace(/\?.*$/,"").replace(/\/?$/,"")!==f.replace(/\/?$/,"")};e.prototype._redirect=function(g,f){if(a.isFunction(g.redirect)){return g.redirect.call(this,f)}else{if(g.redirect===true){this._debug("Redirect to "+f);return b.location.href=f}}};e.prototype._isOrphan=function(f){return(f.element==null)||!a(f.element).length||a(f.element).is(":hidden")&&(a(f.element)[0].namespaceURI!=="http://www.w3.org/2000/svg")};e.prototype._isLast=function(){return this._current<this._steps.length-1};e.prototype._showPopover=function(o,l){var f,g,h,j,m,n,k=this;n=a.extend({},this._options);h=a.isFunction(o.template)?a(o.template(l,o)):a(o.template);g=h.find(".popover-navigation");m=this._isOrphan(o);if(m){o.element="body";o.placement="top";h=h.addClass("orphan")}f=a(o.element);h.addClass("tour-"+this._options.name);if(o.options){a.extend(n,o.options)}if(o.reflex){f.css("cursor","pointer").on("click.tour-"+this._options.name,function(){if(k._isLast()){return k.next()}else{return k.end()}})}if(o.prev<0){g.find("*[data-role=prev]").addClass("disabled")}if(o.next<0){g.find("*[data-role=next]").addClass("disabled")}if(!o.duration){g.find("*[data-role='pause-resume']").remove()}o.template=h.clone().wrap("<div>").parent().html();f.popover({placement:o.placement,trigger:"manual",title:o.title,content:o.content,html:true,animation:o.animation,container:o.container,template:o.template,selector:o.element}).popover("show");j=f.data("bs.popover")?f.data("bs.popover").tip():f.data("popover").tip();j.attr("id",o.id);this._reposition(j,o);if(m){return this._center(j)}};e.prototype._reposition=function(f,m){var g,h,i,j,k,l,n;j=f[0].offsetWidth;h=f[0].offsetHeight;n=f.offset();k=n.left;l=n.top;g=a(b).outerHeight()-n.top-f.outerHeight();if(g<0){n.top=n.top+g}i=a("html").outerWidth()-n.left-f.outerWidth();if(i<0){n.left=n.left+i}if(n.top<0){n.top=0}if(n.left<0){n.left=0}f.offset(n);if(m.placement==="bottom"||m.placement==="top"){if(k!==n.left){return this._replaceArrow(f,(n.left-k)*2,j,"left")}}else{if(l!==n.top){return this._replaceArrow(f,(n.top-l)*2,h,"top")}}};e.prototype._center=function(f){return f.css("top",a(d).outerHeight()/2-f.outerHeight()/2)};e.prototype._replaceArrow=function(f,g,h,i){return f.find(".arrow").css(i,g?50*(1-g/h)+"%":"")};e.prototype._scrollIntoView=function(j,i){var f,g,k,l,m,h=this;if(!j){return i()}f=a(j);g=a(d);k=f.offset().top;m=g.height();l=Math.max(0,k-(m/2));this._debug("Scroll into view. ScrollTop: "+l+". Element offset: "+k+". Window height: "+m+".");return a("body").stop().animate({scrollTop:Math.ceil(l)},function(){i();return h._debug("Scroll into view. Animation end element offset: "+(f.offset().top)+". Window height: "+(g.height())+".")})};e.prototype._onResize=function(f,g){return a(d).on("resize.tour-"+this._options.name,function(){clearTimeout(g);return g=setTimeout(f,100)})};e.prototype._setupMouseNavigation=function(){var f=this;f=this;a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=next]:not(.disabled)").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=next]:not(.disabled)",function(g){g.preventDefault();return f.next()});a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=prev]:not(.disabled)").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=prev]:not(.disabled)",function(g){g.preventDefault();return f.prev()});a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=end]").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=end]",function(g){g.preventDefault();return f.end()});return a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=pause-resume]").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=pause-resume]",function(h){var g;h.preventDefault();g=a(this);g.text(f._paused?g.data("pause-text"):g.data("resume-text"));if(f._paused){return f.resume()}else{return f.pause()}})};e.prototype._setupKeyboardNavigation=function(){var f=this;if(!this._options.keyboard){return}return a(b).on("keyup.tour-"+this._options.name,function(g){if(!g.which){return}switch(g.which){case 39:g.preventDefault();if(f._isLast()){return f.next()}else{return f.end()}break;case 37:g.preventDefault();if(f._current>0){return f.prev()}break;case 27:g.preventDefault();return f.end()}})};e.prototype._makePromise=function(f){if(f&&a.isFunction(f.then)){return f}else{return null}};e.prototype._callOnPromiseDone=function(i,h,g){var f=this;if(i){return i.then(function(j){return h.call(f,g)})}else{return h.call(this,g)}};e.prototype._showBackdrop=function(f){if(this.backdrop.backgroundShown){return}this.backdrop=a("<div/>",{"class":"tour-backdrop"});this.backdrop.backgroundShown=true;return a("body").append(this.backdrop)};e.prototype._hideBackdrop=function(){this._hideOverlayElement();return this._hideBackground()};e.prototype._hideBackground=function(){this.backdrop.remove();this.backdrop.overlay=null;return this.backdrop.backgroundShown=false};e.prototype._showOverlayElement=function(h){var f,g,i;if(this.backdrop.overlayElementShown){return}this.backdrop.overlayElementShown=true;g=a(h);f=a("<div/>");i=g.offset();i.top=i.top;i.left=i.left;f.width(g.innerWidth()).height(g.innerHeight()).addClass("tour-step-background").offset(i);g.addClass("tour-step-backdrop");a("body").append(f);this.backdrop.$element=g;return this.backdrop.$background=f};e.prototype._hideOverlayElement=function(){if(!this.backdrop.overlayElementShown){return}this.backdrop.$element.removeClass("tour-step-backdrop");this.backdrop.$background.remove();this.backdrop.$element=null;this.backdrop.$background=null;return this.backdrop.overlayElementShown=false};e.prototype._clearTimer=function(){d.clearTimeout(this._timer);this._timer=null;return this._duration=null};return e})();return d.Tour=c})(jQuery,window);